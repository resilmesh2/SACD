
<div class="cvss-version-toggle">
    <mat-button-toggle-group
        [(ngModel)]="cvssVersion"
        aria-label="CVSS version selection"
    >          
        <mat-button-toggle value="v4">CVSS v4.0</mat-button-toggle>
        <mat-button-toggle value="v31" checked>CVSS v3.1</mat-button-toggle>
        <mat-button-toggle value="v30">CVSS v3.0</mat-button-toggle>
        <mat-button-toggle value="v2">CVSS v2.0</mat-button-toggle>
    </mat-button-toggle-group>
</div>
<div class="cve-details">
    @if (cvssVersion() === 'v2') {
        <h2>CVSS v2.0 Details</h2>
        <div class="cvss-columns">
            <div class="cvss-column">
                <div>
                    <strong>Base score: </strong>
                    <span [class]="scoreToClassCVSS(cve()?.cvss_v2?.base_score ?? 0, 2)" class="score-text">
                        {{ cve()?.cvss_v2?.base_score ?? "unknown" }}
                    </span>
                </div>
                <div class="cve-code">
                    <strong>Severity:</strong>
                    <cvss-score-chip [label]="scoreToClassCVSS(cve()?.cvss_v2?.base_score ?? 0, 2)"></cvss-score-chip>
                </div>
                <div>
                    <strong>Access vector: </strong>
                    <span class="score-text">{{ cve()?.cvss_v2?.access_vector ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Access complexity: </strong>
                    <span class="score-text">{{ cve()?.cvss_v2?.access_complexity ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Authentication: </strong>
                    <span class="score-text">{{ cve()?.cvss_v2?.authentication ?? "unknown" }}</span>
                </div>

            </div>
            <div class="cvss-column">
                <div>
                    <strong>Confidentiality impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v2?.confidentiality_impact ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Integrity impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v2?.integrity_impact ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Availability impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v2?.availability_impact ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v2?.impact_score ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Exploitability: </strong>
                    <span class="score-text">{{ cve()?.cvss_v2?.exploitability_score ?? "unknown" }}</span>
                </div>
            </div>
        </div>
    } @else if (cvssVersion() === 'v30') {
        <h2>CVSS v3.0 Details</h2>
        <div class="cvss-columns">
            <div class="cvss-column">
                <div>
                    <strong>Base score: </strong>
                    <span [class]="scoreToClassCVSS(cve()?.cvss_v30?.base_score ?? 0, 3)" class="score-text">
                        {{ cve()?.cvss_v30?.base_score ?? "unknown" }}
                    </span>
                </div>
                <div class="cve-code">
                    <strong>Severity:</strong>
                    <cvss-score-chip [label]="scoreToClassCVSS(cve()?.cvss_v30?.base_score ?? 0, 3)"></cvss-score-chip>
                </div>
                <div>
                    <strong>Attack vector: </strong>
                    <span class="score-text">{{ cve()?.cvss_v30?.attack_vector ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Attack complexity: </strong>
                    <span class="score-text">{{ cve()?.cvss_v30?.attack_complexity ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Priviledges required: </strong>
                    <span class="score-text">{{ cve()?.cvss_v30?.privileges_required ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>User interaction: </strong>
                    <span class="score-text">{{ cve()?.cvss_v30?.user_interaction ?? "unknown" }}</span>
                </div>
            </div>
            <div class="cvss-column">
                <div>
                    <strong>Confidentiality impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v30?.confidentiality_impact ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Integrity impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v30?.integrity_impact ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Availability impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v30?.availability_impact ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Scope: </strong>
                    <span class="score-text">{{ cve()?.cvss_v30?.scope ?? "unknown" }}</span>
                </div>
            </div>
        </div>
    } @else if (cvssVersion() === 'v31') {
        <h2>CVSS v3.1 Details</h2>
        <div class="cvss-columns">
            <div class="cvss-column">
                <div>
                    <strong>Base score: </strong>
                    <span [class]="scoreToClassCVSS(cve()?.cvss_v31?.base_score ?? 0, 3)" class="score-text">
                        {{ cve()?.cvss_v31?.base_score ?? "unknown" }}
                    </span>
                </div>
                <div class="cve-code">
                    <strong>Severity:</strong>
                    <cvss-score-chip [label]="scoreToClassCVSS(cve()?.cvss_v31?.base_score ?? 0, 3)"></cvss-score-chip>
                </div>
                <div>
                    <strong>Attack vector: </strong>
                    <span class="score-text">{{ cve()?.cvss_v31?.attack_vector ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Attack complexity: </strong>
                    <span class="score-text">{{ cve()?.cvss_v31?.attack_complexity ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Priviledges required: </strong>
                    <span class="score-text">{{ cve()?.cvss_v31?.privileges_required ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>User interaction: </strong>
                    <span class="score-text">{{ cve()?.cvss_v31?.user_interaction ?? "unknown" }}</span>
                </div>
            </div>
            <div class="cvss-column">
                <div>
                    <strong>Confidentiality impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v31?.confidentiality_impact ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Integrity impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v31?.integrity_impact ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Availability impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v31?.availability_impact ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Scope: </strong>
                    <span class="score-text">{{ cve()?.cvss_v31?.scope ?? "unknown" }}</span>
                </div>
            </div>
        </div>
    } @else if (cvssVersion() === 'v4') {
        <h2>CVSS v4.0 Details</h2>
        <div class="cvss-columns">
            <div class="cvss-column">
                <div>
                    <strong>Base score: </strong>
                    <span [class]="cve()?.cvss_v40?.base_severity?.toLowerCase() ?? 'unknown'" class="score-text">
                        {{ cve()?.cvss_v40?.base_score ?? "unknown" }}
                    </span>
                </div>
                <div class="cve-code">
                    <strong>Severity:</strong>
                    <cvss-score-chip [label]="cve()?.cvss_v40?.base_severity?.toLowerCase() ?? 'unknown'"></cvss-score-chip>
                </div>
                <div>
                    <strong>Attack vector: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.attack_vector ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Attack complexity: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.attack_complexity ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Attack requirements: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.attack_requirements ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Privileges required: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.privileges_required ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>User interaction: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.user_interaction ?? "unknown" }}</span>
                </div>

            </div>
            <div class="cvss-column">
                <div>
                    <strong>Vulnerable system confidentiality impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.vulnerable_system_confidentiality ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Vulnerable system integrity impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.vulnerable_system_integrity ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Vulnerable system availability impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.vulnerable_system_availability ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Subsequent system confidentiality impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.subsequent_system_confidentiality ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Subsequent system integrity impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.subsequent_system_integrity ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Subsequent system availability impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.subsequent_system_availability ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Exploit maturity: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.exploit_maturity ?? "unknown" }}</span>
                </div>
            </div>
        </div>
    }
</div>