
<div class="cvss-version-toggle">
    <mat-button-toggle-group
        [(ngModel)]="cvssVersion"
        aria-label="CVSS version selection"
    >          
        <mat-button-toggle value="v4">CVSS v4.0</mat-button-toggle>
        <mat-button-toggle value="v31" checked>CVSS v3.1</mat-button-toggle>
        <mat-button-toggle value="v30">CVSS v3.0</mat-button-toggle>
        <mat-button-toggle value="v2">CVSS v2.0</mat-button-toggle>
    </mat-button-toggle-group>
</div>
<div class="cve-details">
    @if (cvssVersion() === 'v2') {
        <div class="cvss-header">
            <h2>CVSS v2.0 Details</h2>
            <span class="score-text">
                {{ cve()?.cvss_v2?.vector_string ?? "CVSS:2.0/???" }}
            </span>
        </div>
        <div class="cvss-columns">
            <div class="cvss-column">
                <div>
                    <strong>Base score: </strong>
                    <span [class]="cve()?.cvss_v2?.base_severity?.toLowerCase() ?? 'unknown'" class="score-text">
                        {{ cve()?.cvss_v2?.base_score ?? "unknown" }}
                    </span>
                </div>
                <div class="cve-code">
                    <strong>Severity:</strong>
                    <cvss-chip [label]="cve()?.cvss_v2?.base_severity?.toLowerCase() ?? 'unknown'"></cvss-chip>
                </div>

                <div class="cve-code">
                    <strong>Access vector: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v2?.access_vector ?? 'unknown'"
                        [property]="'access_vector'"
                        [version]="'v2'"
                    >
                    </cvss-chip>
                </div>
                <div class="cve-code">
                    <strong>Access complexity: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v2?.access_complexity ?? 'unknown'"
                        [property]="'access_complexity'"
                        [version]="'v2'"
                    >
                    </cvss-chip>
                </div>
                <div class="cve-code">
                    <strong>Authentication: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v2?.authentication ?? 'unknown'"
                        [property]="'authentication'"
                        [version]="'v2'"
                    >
                    </cvss-chip>
                </div>
            </div>
            <div class="cvss-column">
                <div class="cve-code">
                    <strong>Confidentiality impact: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v2?.confidentiality_impact ?? 'unknown'"
                        [property]="'confidentiality_impact'"
                        [version]="'v2'"
                    >
                    </cvss-chip>
                </div>
                <div class="cve-code">
                    <strong>Integrity impact: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v2?.integrity_impact ?? 'unknown'"
                        [property]="'integrity_impact'"
                        [version]="'v2'"
                    >
                    </cvss-chip>
                </div>
                <div class="cve-code">
                    <strong>Availability impact: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v2?.availability_impact ?? 'unknown'"
                        [property]="'availability_impact'"
                        [version]="'v2'"
                    >
                    </cvss-chip>
                </div>
                <div>
                    <strong>Impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v2?.impact_score ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Exploitability: </strong>
                    <span class="score-text">{{ cve()?.cvss_v2?.exploitability_score ?? "unknown" }}</span>
                </div>
            </div>
        </div>
    } @else if (cvssVersion() === 'v30') {
        <div class="cvss-header">
            <h2>CVSS v3.0 Details</h2>
            <span class="score-text">
                {{ cve()?.cvss_v30?.vector_string ?? "CVSS:3.0/???" }}
            </span>
        </div>
        <div class="cvss-columns">
            <div class="cvss-column">
                <div>
                    <strong>Base score: </strong>
                    <span [class]="cve()?.cvss_v30?.base_severity?.toLowerCase() ?? 'unknown'" class="score-text">
                        {{ cve()?.cvss_v30?.base_score ?? "unknown" }}
                    </span>
                </div>
                <div class="cve-code">
                    <strong>Severity:</strong>
                    <cvss-chip [label]="cve()?.cvss_v30?.base_severity?.toLowerCase() ?? 'unknown'"></cvss-chip>
                </div>
                <div class="cve-code">
                    <strong>Attack vector: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v30?.attack_vector ?? 'unknown'"
                        [property]="'attack_vector'"
                        [version]="'v30'"
                    >
                    </cvss-chip>
                </div>
                <div class="cve-code">
                    <strong>Attack complexity: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v30?.attack_complexity ?? 'unknown'"
                        [property]="'attack_complexity'"
                        [version]="'v30'"
                    >
                    </cvss-chip>
                </div>
                <div class="cve-code">
                    <strong>Privileges required: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v30?.privileges_required ?? 'unknown'"
                        [property]="'privileges_required'"
                        [version]="'v30'"
                    >
                    </cvss-chip>
                </div>
                <div class="cve-code">
                    <strong>User interaction: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v30?.user_interaction ?? 'unknown'"
                        [property]="'user_interaction'"
                        [version]="'v30'"
                    >
                    </cvss-chip>
                </div>
            </div>
            <div class="cvss-column">
                <div class="cve-code">
                    <strong>Confidentiality impact: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v30?.confidentiality_impact ?? 'unknown'"
                        [property]="'confidentiality_impact'"
                        [version]="'v30'"
                    >
                    </cvss-chip>
                </div>
                <div class="cve-code">
                    <strong>Integrity impact: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v30?.integrity_impact ?? 'unknown'"
                        [property]="'integrity_impact'"
                        [version]="'v30'"
                    >
                    </cvss-chip>
                </div>
                <div class="cve-code">
                    <strong>Availability impact: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v30?.availability_impact ?? 'unknown'"
                        [property]="'availability_impact'"
                        [version]="'v30'"
                    >
                    </cvss-chip>
                </div>
                <div class="cve-code">
                    <strong>Scope: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v30?.scope ?? 'unknown'"
                        [property]="'scope'"
                        [version]="'v30'"
                    >
                    </cvss-chip>
                </div>
            </div>
        </div>
    } @else if (cvssVersion() === 'v31') {
        <div class="cvss-header">
            <h2>CVSS v3.1 Details</h2>
            <span class="score-text">
                {{ cve()?.cvss_v31?.vector_string ?? "CVSS:3.1/???" }}
            </span>
        </div>
        <div class="cvss-columns">
            <div class="cvss-column">
                <div>
                    <strong>Base score: </strong>
                    <span [class]="scoreToClassCVSS(cve()?.cvss_v31?.base_score ?? 0, 3)" class="score-text">
                        {{ cve()?.cvss_v31?.base_score ?? "unknown" }}
                    </span>
                </div>
                <div class="cve-code">
                    <strong>Severity:</strong>
                    <cvss-chip [label]="scoreToClassCVSS(cve()?.cvss_v31?.base_score ?? 0, 3)"></cvss-chip>
                </div>
                <div class="cve-code">
                    <strong>Attack vector: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v31?.attack_vector"
                        [property]="'attack_vector'"
                        [version]="'v31'"
                    >
                    </cvss-chip>
                </div>
                <div class="cve-code">
                    <strong>Attack complexity: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v31?.attack_complexity"
                        [property]="'attack_complexity'"
                        [version]="'v31'"
                    >
                    </cvss-chip>
                </div>
                <div class="cve-code">
                    <strong>Priviledges required: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v31?.privileges_required"
                        [property]="'privileges_required'"
                        [version]="'v31'"
                    >
                    </cvss-chip>
                </div>
                <div class="cve-code">
                    <strong>User interaction: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v31?.user_interaction"
                        [property]="'user_interaction'"
                        [version]="'v31'"
                    >
                    </cvss-chip>
                </div>
            </div>
            <div class="cvss-column">
                <div class="cve-code">
                    <strong>Confidentiality impact: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v31?.confidentiality_impact"
                        [property]="'confidentiality_impact'"
                        [version]="'v31'"
                    >
                    </cvss-chip>
                </div>
                <div class="cve-code">
                    <strong>Integrity impact: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v31?.integrity_impact"
                        [property]="'integrity_impact'"
                        [version]="'v31'"
                    >
                    </cvss-chip>
                </div>
                <div class="cve-code">
                    <strong>Availability impact: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v31?.availability_impact"
                        [property]="'availability_impact'"
                        [version]="'v31'"
                    >
                    </cvss-chip>
                </div>
                <div class="cve-code">
                    <strong>Scope: </strong>
                    <cvss-chip 
                        [label]="cve()?.cvss_v31?.scope"
                        [property]="'scope'"
                        [version]="'v31'"
                    >
                    </cvss-chip>
                </div>
            </div>
        </div>
    } @else if (cvssVersion() === 'v4') {
        <div class="cvss-header">
            <h2>CVSS v4.0 Details</h2>
            <span class="score-text">
                {{ cve()?.cvss_v40?.vector_string ?? "CVSS:4.0/???" }}
            </span>
        </div>
        <div class="cvss-columns">
            <div class="cvss-column">
                <div>
                    <strong>Base score: </strong>
                    <span [class]="cve()?.cvss_v40?.base_severity?.toLowerCase() ?? 'unknown'" class="score-text">
                        {{ cve()?.cvss_v40?.base_score ?? "unknown" }}
                    </span>
                </div>
                <div class="cve-code">
                    <strong>Severity:</strong>
                    <cvss-chip [label]="cve()?.cvss_v40?.base_severity?.toLowerCase() ?? 'unknown'"></cvss-chip>
                </div>
                <div>
                    <strong>Attack vector: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.attack_vector ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Attack complexity: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.attack_complexity ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Attack requirements: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.attack_requirements ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Privileges required: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.privileges_required ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>User interaction: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.user_interaction ?? "unknown" }}</span>
                </div>
            </div>
            <div class="cvss-column">
                <div>
                    <strong>Vulnerable system confidentiality impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.vulnerable_system_confidentiality ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Vulnerable system integrity impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.vulnerable_system_integrity ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Vulnerable system availability impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.vulnerable_system_availability ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Subsequent system confidentiality impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.subsequent_system_confidentiality ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Subsequent system integrity impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.subsequent_system_integrity ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Subsequent system availability impact: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.subsequent_system_availability ?? "unknown" }}</span>
                </div>
                <div>
                    <strong>Exploit maturity: </strong>
                    <span class="score-text">{{ cve()?.cvss_v40?.exploit_maturity ?? "unknown" }}</span>
                </div>
            </div>
        </div>
    }
</div>