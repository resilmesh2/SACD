import { ChangeDetectionStrategy, Component, input, signal } from "@angular/core";
import { CVE } from "../../../models/vulnerability.model";
import { MatButtonToggleModule } from "@angular/material/button-toggle";
import { FormsModule, ReactiveFormsModule } from "@angular/forms";
import { MatInputModule } from "@angular/material/input";
import { CvssChipComponent } from "../../../components/cvss-color-chip/cvss-chip.component";
import { scoreToClassCVSS } from "../../../utils/utils";


@Component({
  selector: 'cvss-report',
  templateUrl: 'cvss-report.component.html',
  styleUrls: ['cvss-report.component.scss'],
  changeDetection: ChangeDetectionStrategy.OnPush,
  imports: [
    MatButtonToggleModule,
    MatInputModule,
    FormsModule,
    ReactiveFormsModule,
    CvssChipComponent
  ]
})

export class CvssReportComponent {
  // Component logic goes here
  cve = input<CVE | null>(null);
  cvssVersion = signal<'v2' | 'v30' | 'v31' | 'v4'>('v31');

  scoreToClassCVSS(score: number, version: number): string {
    return scoreToClassCVSS(score, version);
  }

}