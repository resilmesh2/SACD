import { BehaviorSubject } from 'rxjs';
export class RequestedPaginationManager {
    constructor(pageSize, initial) {
        this.defaultPageSize = pageSize;
        const event = initial ?? this.createInitialPagination();
        this.pagination$ = new BehaviorSubject(event);
    }
    update(pagination) {
        if (this.hasSortingChanged(pagination) || this.hasPageSizeChanged(pagination)) {
            this.resetPosition(pagination);
        }
        else {
            this.pagination$.next({ ...pagination });
        }
    }
    resetSize() {
        const curr = this.pagination$.getValue();
        if (curr) {
            curr.size = this.defaultPageSize;
            this.pagination$.next({ ...curr });
        }
    }
    hasSortingChanged(next) {
        const curr = this.pagination$.getValue();
        if (!curr) {
            return false;
        }
        const isDifferent = next.sort !== curr.sort || next.sortDir !== curr.sortDir;
        if (isDifferent) {
            return (!this.isDifferentEmptyValues(next.sort, curr.sort) || !this.isDifferentEmptyValues(next.sortDir, curr.sortDir));
        }
        return false;
    }
    hasPageSizeChanged(pagination) {
        const curr = this.pagination$.getValue();
        if (curr) {
            return pagination.size !== curr.size;
        }
        else {
            return false;
        }
    }
    isDifferentEmptyValues(valueA, valueB) {
        return ((valueA === undefined || valueA === null || valueA === '') &&
            (valueB === undefined || valueB === null || valueB === ''));
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVxdWVzdGVkLXBhZ2luYXRpb24tbWFuYWdlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL3NlbnRpbmVsLWNvbW1vbi9wYWdpbmF0aW9uL3NyYy9tYW5hZ2VyL3JlcXVlc3RlZC1wYWdpbmF0aW9uLW1hbmFnZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUd2QyxNQUFNLE9BQWdCLDBCQUEwQjtJQUk5QyxZQUFzQixRQUFnQixFQUFFLE9BQTBCO1FBQ2hFLElBQUksQ0FBQyxlQUFlLEdBQUcsUUFBUSxDQUFDO1FBQ2hDLE1BQU0sS0FBSyxHQUFHLE9BQU8sSUFBSSxJQUFJLENBQUMsdUJBQXVCLEVBQUUsQ0FBQztRQUN4RCxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksZUFBZSxDQUFtQixLQUFLLENBQUMsQ0FBQztJQUNsRSxDQUFDO0lBS0QsTUFBTSxDQUFDLFVBQTRCO1FBQ2pDLElBQUksSUFBSSxDQUFDLGlCQUFpQixDQUFDLFVBQVUsQ0FBQyxJQUFJLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDO1lBQzlFLElBQUksQ0FBQyxhQUFhLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDakMsQ0FBQzthQUFNLENBQUM7WUFDTixJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxFQUFFLEdBQUcsVUFBVSxFQUFFLENBQUMsQ0FBQztRQUMzQyxDQUFDO0lBQ0gsQ0FBQztJQUVELFNBQVM7UUFDUCxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQ3pDLElBQUksSUFBSSxFQUFFLENBQUM7WUFDVCxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUM7WUFDakMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsRUFBRSxHQUFHLElBQUksRUFBRSxDQUFDLENBQUM7UUFDckMsQ0FBQztJQUNILENBQUM7SUFFTyxpQkFBaUIsQ0FBQyxJQUFzQjtRQUM5QyxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQ3pDLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUNWLE9BQU8sS0FBSyxDQUFDO1FBQ2YsQ0FBQztRQUNELE1BQU0sV0FBVyxHQUFHLElBQUksQ0FBQyxJQUFJLEtBQUssSUFBSSxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsT0FBTyxLQUFLLElBQUksQ0FBQyxPQUFPLENBQUM7UUFDN0UsSUFBSSxXQUFXLEVBQUUsQ0FBQztZQUNoQixPQUFPLENBQ0wsQ0FBQyxJQUFJLENBQUMsc0JBQXNCLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsc0JBQXNCLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsT0FBTyxDQUFDLENBQy9HLENBQUM7UUFDSixDQUFDO1FBQ0QsT0FBTyxLQUFLLENBQUM7SUFDZixDQUFDO0lBRU8sa0JBQWtCLENBQUMsVUFBNEI7UUFDckQsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUN6QyxJQUFJLElBQUksRUFBRSxDQUFDO1lBQ1QsT0FBTyxVQUFVLENBQUMsSUFBSSxLQUFLLElBQUksQ0FBQyxJQUFJLENBQUM7UUFDdkMsQ0FBQzthQUFNLENBQUM7WUFDTixPQUFPLEtBQUssQ0FBQztRQUNmLENBQUM7SUFDSCxDQUFDO0lBRU8sc0JBQXNCLENBQUMsTUFBaUMsRUFBRSxNQUFpQztRQUNqRyxPQUFPLENBQ0wsQ0FBQyxNQUFNLEtBQUssU0FBUyxJQUFJLE1BQU0sS0FBSyxJQUFJLElBQUksTUFBTSxLQUFLLEVBQUUsQ0FBQztZQUMxRCxDQUFDLE1BQU0sS0FBSyxTQUFTLElBQUksTUFBTSxLQUFLLElBQUksSUFBSSxNQUFNLEtBQUssRUFBRSxDQUFDLENBQzNELENBQUM7SUFDSixDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCZWhhdmlvclN1YmplY3QgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IElQYWdpbmF0aW9uRXZlbnQgfSBmcm9tICcuLi9yZXF1ZXN0ZWQvaS1wYWdpbmF0aW9uLWV2ZW50JztcblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFJlcXVlc3RlZFBhZ2luYXRpb25NYW5hZ2VyIHtcbiAgcmVhZG9ubHkgZGVmYXVsdFBhZ2VTaXplOiBudW1iZXI7XG4gIHBhZ2luYXRpb24kOiBCZWhhdmlvclN1YmplY3Q8SVBhZ2luYXRpb25FdmVudD47XG5cbiAgcHJvdGVjdGVkIGNvbnN0cnVjdG9yKHBhZ2VTaXplOiBudW1iZXIsIGluaXRpYWw/OiBJUGFnaW5hdGlvbkV2ZW50KSB7XG4gICAgdGhpcy5kZWZhdWx0UGFnZVNpemUgPSBwYWdlU2l6ZTtcbiAgICBjb25zdCBldmVudCA9IGluaXRpYWwgPz8gdGhpcy5jcmVhdGVJbml0aWFsUGFnaW5hdGlvbigpO1xuICAgIHRoaXMucGFnaW5hdGlvbiQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PElQYWdpbmF0aW9uRXZlbnQ+KGV2ZW50KTtcbiAgfVxuXG4gIGFic3RyYWN0IHJlc2V0UG9zaXRpb24ocGFnaW5hdGlvbj86IElQYWdpbmF0aW9uRXZlbnQpOiB2b2lkO1xuICBwcm90ZWN0ZWQgYWJzdHJhY3QgY3JlYXRlSW5pdGlhbFBhZ2luYXRpb24oKTogSVBhZ2luYXRpb25FdmVudDtcblxuICB1cGRhdGUocGFnaW5hdGlvbjogSVBhZ2luYXRpb25FdmVudCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmhhc1NvcnRpbmdDaGFuZ2VkKHBhZ2luYXRpb24pIHx8IHRoaXMuaGFzUGFnZVNpemVDaGFuZ2VkKHBhZ2luYXRpb24pKSB7XG4gICAgICB0aGlzLnJlc2V0UG9zaXRpb24ocGFnaW5hdGlvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucGFnaW5hdGlvbiQubmV4dCh7IC4uLnBhZ2luYXRpb24gfSk7XG4gICAgfVxuICB9XG5cbiAgcmVzZXRTaXplKCk6IHZvaWQge1xuICAgIGNvbnN0IGN1cnIgPSB0aGlzLnBhZ2luYXRpb24kLmdldFZhbHVlKCk7XG4gICAgaWYgKGN1cnIpIHtcbiAgICAgIGN1cnIuc2l6ZSA9IHRoaXMuZGVmYXVsdFBhZ2VTaXplO1xuICAgICAgdGhpcy5wYWdpbmF0aW9uJC5uZXh0KHsgLi4uY3VyciB9KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGhhc1NvcnRpbmdDaGFuZ2VkKG5leHQ6IElQYWdpbmF0aW9uRXZlbnQpOiBib29sZWFuIHtcbiAgICBjb25zdCBjdXJyID0gdGhpcy5wYWdpbmF0aW9uJC5nZXRWYWx1ZSgpO1xuICAgIGlmICghY3Vycikge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBjb25zdCBpc0RpZmZlcmVudCA9IG5leHQuc29ydCAhPT0gY3Vyci5zb3J0IHx8IG5leHQuc29ydERpciAhPT0gY3Vyci5zb3J0RGlyO1xuICAgIGlmIChpc0RpZmZlcmVudCkge1xuICAgICAgcmV0dXJuIChcbiAgICAgICAgIXRoaXMuaXNEaWZmZXJlbnRFbXB0eVZhbHVlcyhuZXh0LnNvcnQsIGN1cnIuc29ydCkgfHwgIXRoaXMuaXNEaWZmZXJlbnRFbXB0eVZhbHVlcyhuZXh0LnNvcnREaXIsIGN1cnIuc29ydERpcilcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHByaXZhdGUgaGFzUGFnZVNpemVDaGFuZ2VkKHBhZ2luYXRpb246IElQYWdpbmF0aW9uRXZlbnQpOiBib29sZWFuIHtcbiAgICBjb25zdCBjdXJyID0gdGhpcy5wYWdpbmF0aW9uJC5nZXRWYWx1ZSgpO1xuICAgIGlmIChjdXJyKSB7XG4gICAgICByZXR1cm4gcGFnaW5hdGlvbi5zaXplICE9PSBjdXJyLnNpemU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGlzRGlmZmVyZW50RW1wdHlWYWx1ZXModmFsdWVBOiBzdHJpbmcgfCB1bmRlZmluZWQgfCBudWxsLCB2YWx1ZUI6IHN0cmluZyB8IHVuZGVmaW5lZCB8IG51bGwpOiBib29sZWFuIHtcbiAgICByZXR1cm4gKFxuICAgICAgKHZhbHVlQSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlQSA9PT0gbnVsbCB8fCB2YWx1ZUEgPT09ICcnKSAmJlxuICAgICAgKHZhbHVlQiA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlQiA9PT0gbnVsbCB8fCB2YWx1ZUIgPT09ICcnKVxuICAgICk7XG4gIH1cbn1cbiJdfQ==