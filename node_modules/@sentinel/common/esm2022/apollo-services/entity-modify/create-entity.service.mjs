import { EntityModifyBaseService } from './entity-modify-base.service';
import { of } from 'rxjs';
import { concatMap, tap } from 'rxjs/operators';
export class CreateEntityService extends EntityModifyBaseService {
    constructor(entityName, notificationService) {
        super(entityName, notificationService);
        this.notificationService = notificationService;
    }
    save() {
        return this.form$.pipe(concatMap((form) => (form.valid ? this.validFormSave() : of(false))));
    }
    createSuccessSaveMessage() {
        return `${this.entityName} was created`;
    }
    createErrorSaveMessage() {
        const lowerCasedEntity = this.entityName.toLowerCase();
        return `Creating ${lowerCasedEntity}`;
    }
    validFormSave() {
        return this.form$.pipe(tap(() => this.isSavingSubject$.next(true)), concatMap((form) => this.createEntity(form).pipe(concatMap((result) => this.handleSaveResult(form, result)))), tap({
            next: () => this.isSavingSubject$.next(false),
            error: () => this.isSavingSubject$.next(false),
        }));
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlLWVudGl0eS5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvc2VudGluZWwtY29tbW9uL2Fwb2xsby1zZXJ2aWNlcy9zcmMvZW50aXR5LW1vZGlmeS9jcmVhdGUtZW50aXR5LnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDdkUsT0FBTyxFQUFjLEVBQUUsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUV0QyxPQUFPLEVBQUUsU0FBUyxFQUFFLEdBQUcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBR2hELE1BQU0sT0FBZ0IsbUJBS3BCLFNBQVEsdUJBQXdDO0lBQ2hELFlBQ0UsVUFBa0IsRUFDUixtQkFBNEM7UUFFdEQsS0FBSyxDQUFDLFVBQVUsRUFBRSxtQkFBbUIsQ0FBQyxDQUFDO1FBRjdCLHdCQUFtQixHQUFuQixtQkFBbUIsQ0FBeUI7SUFHeEQsQ0FBQztJQUlELElBQUk7UUFDRixPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUMvRixDQUFDO0lBRVMsd0JBQXdCO1FBQ2hDLE9BQU8sR0FBRyxJQUFJLENBQUMsVUFBVSxjQUFjLENBQUM7SUFDMUMsQ0FBQztJQUVTLHNCQUFzQjtRQUM5QixNQUFNLGdCQUFnQixHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDdkQsT0FBTyxZQUFZLGdCQUFnQixFQUFFLENBQUM7SUFDeEMsQ0FBQztJQUVPLGFBQWE7UUFDbkIsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FDcEIsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsRUFDM0MsU0FBUyxDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQzdHLEdBQUcsQ0FBQztZQUNGLElBQUksRUFBRSxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQztZQUM3QyxLQUFLLEVBQUUsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7U0FDL0MsQ0FBQyxDQUNILENBQUM7SUFDSixDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCYXNlUmVhY3RpdmVGb3JtIH0gZnJvbSAnQHNlbnRpbmVsL2NvbW1vbic7XG5pbXBvcnQgeyBOb3RpZmljYXRpb25TZXJ2aWNlQmFzZSB9IGZyb20gJy4vbm90aWZpY2F0aW9uLXNlcnZpY2UuYmFzZSc7XG5pbXBvcnQgeyBFbnRpdHlNb2RpZnlCYXNlU2VydmljZSB9IGZyb20gJy4vZW50aXR5LW1vZGlmeS1iYXNlLnNlcnZpY2UnO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgb2YgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IEFwb2xsb1Jlc3VsdCB9IGZyb20gJ0BzZW50aW5lbC9jb21tb24vZ3JhcGhxbCc7XG5pbXBvcnQgeyBjb25jYXRNYXAsIHRhcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IEFic3RyYWN0Q29udHJvbCB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIENyZWF0ZUVudGl0eVNlcnZpY2U8XG4gIEZvcm1Nb2RlbCBleHRlbmRzIHtcbiAgICBbSyBpbiBrZXlvZiBGb3JtTW9kZWxdOiBBYnN0cmFjdENvbnRyb2w8dW5rbm93bj47XG4gIH0sXG4gIEZvcm0gZXh0ZW5kcyBCYXNlUmVhY3RpdmVGb3JtPEZvcm1Nb2RlbD4sXG4+IGV4dGVuZHMgRW50aXR5TW9kaWZ5QmFzZVNlcnZpY2U8Rm9ybU1vZGVsLCBGb3JtPiB7XG4gIHByb3RlY3RlZCBjb25zdHJ1Y3RvcihcbiAgICBlbnRpdHlOYW1lOiBzdHJpbmcsXG4gICAgcHJvdGVjdGVkIG5vdGlmaWNhdGlvblNlcnZpY2U6IE5vdGlmaWNhdGlvblNlcnZpY2VCYXNlLFxuICApIHtcbiAgICBzdXBlcihlbnRpdHlOYW1lLCBub3RpZmljYXRpb25TZXJ2aWNlKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBhYnN0cmFjdCBjcmVhdGVFbnRpdHkoZm9ybTogRm9ybSk6IE9ic2VydmFibGU8QXBvbGxvUmVzdWx0PjtcblxuICBzYXZlKCk6IE9ic2VydmFibGU8Ym9vbGVhbj4ge1xuICAgIHJldHVybiB0aGlzLmZvcm0kLnBpcGUoY29uY2F0TWFwKChmb3JtKSA9PiAoZm9ybS52YWxpZCA/IHRoaXMudmFsaWRGb3JtU2F2ZSgpIDogb2YoZmFsc2UpKSkpO1xuICB9XG5cbiAgcHJvdGVjdGVkIGNyZWF0ZVN1Y2Nlc3NTYXZlTWVzc2FnZSgpOiBzdHJpbmcge1xuICAgIHJldHVybiBgJHt0aGlzLmVudGl0eU5hbWV9IHdhcyBjcmVhdGVkYDtcbiAgfVxuXG4gIHByb3RlY3RlZCBjcmVhdGVFcnJvclNhdmVNZXNzYWdlKCk6IHN0cmluZyB7XG4gICAgY29uc3QgbG93ZXJDYXNlZEVudGl0eSA9IHRoaXMuZW50aXR5TmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIHJldHVybiBgQ3JlYXRpbmcgJHtsb3dlckNhc2VkRW50aXR5fWA7XG4gIH1cblxuICBwcml2YXRlIHZhbGlkRm9ybVNhdmUoKTogT2JzZXJ2YWJsZTxib29sZWFuPiB7XG4gICAgcmV0dXJuIHRoaXMuZm9ybSQucGlwZShcbiAgICAgIHRhcCgoKSA9PiB0aGlzLmlzU2F2aW5nU3ViamVjdCQubmV4dCh0cnVlKSksXG4gICAgICBjb25jYXRNYXAoKGZvcm0pID0+IHRoaXMuY3JlYXRlRW50aXR5KGZvcm0pLnBpcGUoY29uY2F0TWFwKChyZXN1bHQpID0+IHRoaXMuaGFuZGxlU2F2ZVJlc3VsdChmb3JtLCByZXN1bHQpKSkpLFxuICAgICAgdGFwKHtcbiAgICAgICAgbmV4dDogKCkgPT4gdGhpcy5pc1NhdmluZ1N1YmplY3QkLm5leHQoZmFsc2UpLFxuICAgICAgICBlcnJvcjogKCkgPT4gdGhpcy5pc1NhdmluZ1N1YmplY3QkLm5leHQoZmFsc2UpLFxuICAgICAgfSksXG4gICAgKTtcbiAgfVxufVxuIl19