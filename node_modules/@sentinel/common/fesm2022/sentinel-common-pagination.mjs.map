{"version":3,"file":"sentinel-common-pagination.mjs","sources":["../../../projects/sentinel-common/pagination/src/utils.ts","../../../projects/sentinel-common/pagination/src/wrapper/paginated-resource.ts","../../../projects/sentinel-common/pagination/src/response/i-pagination.ts","../../../projects/sentinel-common/pagination/src/response/pagination-base.ts","../../../projects/sentinel-common/pagination/src/response/cursor-pagination.ts","../../../projects/sentinel-common/pagination/src/response/offset-pagination.ts","../../../projects/sentinel-common/pagination/src/requested/i-pagination-event.ts","../../../projects/sentinel-common/pagination/src/requested/pagination-base-event.ts","../../../projects/sentinel-common/pagination/src/requested/cursor-pagination-event.ts","../../../projects/sentinel-common/pagination/src/requested/offset-pagination-event.ts","../../../projects/sentinel-common/pagination/src/manager/requested-pagination-manager.ts","../../../projects/sentinel-common/pagination/src/manager/cursor-requested-pagination-manager.ts","../../../projects/sentinel-common/pagination/src/manager/offset-requested-pagination-manager.ts","../../../projects/sentinel-common/pagination/src/sentinel-common-pagination.ts"],"sourcesContent":["import { IPaginatedElements } from './wrapper/i-paginated-elements';\n\nexport function isPaginatedElements(object: object): object is IPaginatedElements<unknown> {\n  return 'elements' in object && 'pagination' in object;\n}\n","import { IPagination } from '../response/i-pagination';\nimport { IPaginatedElements } from './i-paginated-elements';\n\nexport class PaginatedResource<T> implements IPaginatedElements<T> {\n  elements: T[];\n  pagination: IPagination;\n\n  constructor(elements: T[], pagination: IPagination) {\n    this.elements = elements;\n    this.pagination = pagination;\n  }\n}\n","import { IOffsetPagination } from './i-offset-pagination';\nimport { ICursorPagination } from './i-cursor-pagination';\n\nexport interface IPagination {\n  numberOfElements: number;\n  size: number;\n  totalElements: number;\n}\n\nexport function isOffsetPagination(pagination: IPagination): pagination is IOffsetPagination {\n  return (pagination as IOffsetPagination).page !== undefined;\n}\n\nexport function isCursorPagination(pagination: IPagination): pagination is ICursorPagination {\n  const maybeCursorPagination = pagination as ICursorPagination;\n  return (\n    maybeCursorPagination.curr !== undefined &&\n    maybeCursorPagination.next !== undefined &&\n    maybeCursorPagination.previous !== undefined\n  );\n}\n","import { IPagination } from './i-pagination';\n\nexport abstract class PaginationBase implements IPagination {\n  numberOfElements: number;\n  size: number;\n  totalElements: number;\n\n  protected constructor(numberOfElements: number, size: number, totalElements: number) {\n    this.numberOfElements = numberOfElements;\n    this.size = size;\n    this.totalElements = totalElements;\n  }\n}\n","import { PaginationBase } from './pagination-base';\nimport { ICursorPagination } from './i-cursor-pagination';\n\nexport class CursorPagination extends PaginationBase implements ICursorPagination {\n  curr: string | null;\n  next: string | null;\n  previous: string | null;\n\n  constructor(\n    curr: string | null,\n    numberOfElements: number,\n    size: number,\n    totalElements: number,\n    next: string | null,\n    previous: string | null,\n  ) {\n    super(numberOfElements, size, totalElements);\n    this.curr = curr;\n    this.next = next;\n    this.previous = previous;\n  }\n}\n","import { PaginationBase } from './pagination-base';\nimport { IOffsetPagination } from './i-offset-pagination';\n\nexport class OffsetPagination extends PaginationBase implements IOffsetPagination {\n  page: number;\n  totalPages: number;\n\n  constructor(page: number, numberOfElements: number, size: number, totalElements: number, totalPages: number) {\n    super(numberOfElements, size, totalElements);\n    this.page = page;\n    this.totalPages = totalPages;\n  }\n}\n","import { IOffsetPaginationEvent } from './i-offset-pagination-event';\nimport { ICursorPaginationEvent } from './i-cursor-pagination-event';\n\nexport type SortDir = 'asc' | 'desc';\n\nexport interface IPaginationEvent {\n  size: number;\n  sort?: string;\n  sortDir?: SortDir;\n}\n\nexport function isOffsetEvent(event: IPaginationEvent): event is IOffsetPaginationEvent {\n  return (event as IOffsetPaginationEvent).page !== undefined;\n}\n\nexport function isCursorEvent(event: IPaginationEvent): event is ICursorPaginationEvent {\n  return (event as ICursorPaginationEvent).cursor !== undefined;\n}\n","import { IPaginationEvent, SortDir } from './i-pagination-event';\n\nexport abstract class PaginationBaseEvent implements IPaginationEvent {\n  size: number;\n  sort?: string;\n  sortDir?: SortDir;\n\n  protected constructor(size: number, sort?: string, sortDir?: SortDir) {\n    this.size = size;\n    this.sort = sort;\n    this.sortDir = sortDir;\n  }\n}\n","import { PaginationBaseEvent } from './pagination-base-event';\nimport { ICursorPaginationEvent } from './i-cursor-pagination-event';\nimport { SortDir } from './i-pagination-event';\n\nexport class CursorPaginationEvent extends PaginationBaseEvent implements ICursorPaginationEvent {\n  cursor: string | null;\n\n  constructor(cursor: string | null, size: number, sort?: string, sortDir?: SortDir) {\n    super(size, sort, sortDir);\n    this.cursor = cursor;\n  }\n}\n","import { PaginationBaseEvent } from './pagination-base-event';\nimport { IOffsetPaginationEvent } from './i-offset-pagination-event';\nimport { SortDir } from './i-pagination-event';\n\nexport class OffsetPaginationEvent extends PaginationBaseEvent implements IOffsetPaginationEvent {\n  page: number;\n\n  constructor(page: number, size: number, sort?: string, sortDir?: SortDir) {\n    super(size, sort, sortDir);\n    this.page = page;\n  }\n}\n","import { BehaviorSubject } from 'rxjs';\nimport { IPaginationEvent } from '../requested/i-pagination-event';\n\nexport abstract class RequestedPaginationManager {\n  readonly defaultPageSize: number;\n  pagination$: BehaviorSubject<IPaginationEvent>;\n\n  protected constructor(pageSize: number, initial?: IPaginationEvent) {\n    this.defaultPageSize = pageSize;\n    const event = initial ?? this.createInitialPagination();\n    this.pagination$ = new BehaviorSubject<IPaginationEvent>(event);\n  }\n\n  abstract resetPosition(pagination?: IPaginationEvent): void;\n  protected abstract createInitialPagination(): IPaginationEvent;\n\n  update(pagination: IPaginationEvent): void {\n    if (this.hasSortingChanged(pagination) || this.hasPageSizeChanged(pagination)) {\n      this.resetPosition(pagination);\n    } else {\n      this.pagination$.next({ ...pagination });\n    }\n  }\n\n  resetSize(): void {\n    const curr = this.pagination$.getValue();\n    if (curr) {\n      curr.size = this.defaultPageSize;\n      this.pagination$.next({ ...curr });\n    }\n  }\n\n  private hasSortingChanged(next: IPaginationEvent): boolean {\n    const curr = this.pagination$.getValue();\n    if (!curr) {\n      return false;\n    }\n    const isDifferent = next.sort !== curr.sort || next.sortDir !== curr.sortDir;\n    if (isDifferent) {\n      return (\n        !this.isDifferentEmptyValues(next.sort, curr.sort) || !this.isDifferentEmptyValues(next.sortDir, curr.sortDir)\n      );\n    }\n    return false;\n  }\n\n  private hasPageSizeChanged(pagination: IPaginationEvent): boolean {\n    const curr = this.pagination$.getValue();\n    if (curr) {\n      return pagination.size !== curr.size;\n    } else {\n      return false;\n    }\n  }\n\n  private isDifferentEmptyValues(valueA: string | undefined | null, valueB: string | undefined | null): boolean {\n    return (\n      (valueA === undefined || valueA === null || valueA === '') &&\n      (valueB === undefined || valueB === null || valueB === '')\n    );\n  }\n}\n","import { RequestedPaginationManager } from './requested-pagination-manager';\nimport { CursorPaginationEvent } from '../requested/cursor-pagination-event';\nimport { ICursorPaginationEvent } from '../requested/i-cursor-pagination-event';\n\nexport class CursorRequestedPaginationManager extends RequestedPaginationManager {\n  constructor(pageSize: number, initial?: ICursorPaginationEvent) {\n    super(pageSize, initial);\n  }\n\n  protected createInitialPagination(): ICursorPaginationEvent {\n    return new CursorPaginationEvent(null, this.defaultPageSize, undefined, undefined);\n  }\n\n  resetPosition(onEvent?: ICursorPaginationEvent): void {\n    const pagination = onEvent ?? (this.pagination$.getValue() as ICursorPaginationEvent);\n    pagination.cursor = null;\n    this.pagination$.next({ ...pagination });\n  }\n}\n","import { RequestedPaginationManager } from './requested-pagination-manager';\nimport { IOffsetPaginationEvent } from '../requested/i-offset-pagination-event';\nimport { OffsetPaginationEvent } from '../requested/offset-pagination-event';\n\nexport class OffsetRequestedPaginationManager extends RequestedPaginationManager {\n  constructor(pageSize: number, initial?: IOffsetPaginationEvent) {\n    super(pageSize, initial);\n  }\n\n  protected createInitialPagination(): IOffsetPaginationEvent {\n    return new OffsetPaginationEvent(0, this.defaultPageSize, undefined, undefined);\n  }\n\n  resetPosition(onEvent?: IOffsetPaginationEvent): void {\n    const curr = onEvent ?? (this.pagination$.getValue() as IOffsetPaginationEvent);\n    curr.page = 0;\n    this.pagination$.next({ ...curr });\n  }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":"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"}